<!DOCTYPE html>
<html>
<head>
  <title>Customer Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">VRMS - Customer</span>

      <span class="navbar-text text-light me-3">
        Welcome, {{ session['name'] }}
      </span>

      <div>
        <a href="#myRentals" class="btn btn-outline-light btn-sm me-2">My Rentals</a>
        <a href="/customer/payments" class="btn btn-outline-light btn-sm me-2">My Payments</a>
        <a href="/profile" class="btn btn-outline-light btn-sm me-2">My Profile</a>
        <a href="/logout" class="btn btn-outline-light btn-sm">Logout</a>
      </div>


    </div>
  </nav>




  <div class="container mt-4">
    <div class="row">
      <!-- Available Vehicles -->
      <div class="col-md-7">
        <h4>Available Vehicles</h4>

        <form method="get" class="row g-2 mb-3">
          <div class="col-md-3">
            <input type="text" name="type" class="form-control form-control-sm"
                  placeholder="Type (Car, Bike...)" value="{{ f_type }}">
          </div>
          <div class="col-md-4">
            <input type="text" name="model" class="form-control form-control-sm"
                  placeholder="Model" value="{{ f_model }}">
          </div>
          <div class="col-md-3">
            <input type="number" step="0.01" name="max_price" class="form-control form-control-sm"
                  placeholder="Max Price" value="{{ f_max_price }}">
          </div>
          <div class="col-md-2">
            <button class="btn btn-sm btn-primary w-100">Filter</button>
          </div>
        </form>

        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>ID</th><th>Type</th><th>Model</th><th>Price/day</th><th></th>
            </tr>
          </thead>
          <tbody>
          {% for v in vehicles %}
            <tr>
              <td>{{ v.VehicleID }}</td>
              <td>{{ v.VehicleType }}</td>
              <td>{{ v.Model }}</td>
              <td>${{ v.RentalPrice }}</td>
              <td>
                <form method="post" action="/customer/rent/{{ v.VehicleID }}" class="d-flex">
                  <input type="number" name="days" min="1" value="1"
                        class="form-control form-control-sm me-2" style="width: 70px;">
                  <button class="btn btn-sm btn-success">Rent</button>
                </form>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- My Active Rentals -->
      <div class="col-md-5" id="myRentals">
        <h4>My Active Rentals</h4>
        {% if active_rentals %}
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>RentalID</th><th>Vehicle</th><th>Date</th><th>Total</th><th></th>
            </tr>
          </thead>
          <tbody>
          {% for r in active_rentals %}
            <tr>
              <td>{{ r.RentalID }}</td>
              <td>{{ r.VehicleType }} - {{ r.Model }}</td>
              <td>{{ r.RentalDate }}</td>
              <td>${{ r.TotalAmount }}</td>
              <td>
                <a href="/customer/return/{{ r.RentalID }}" class="btn btn-sm btn-warning">
                  Return
                </a>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
        {% else %}
          <p>No active rentals.</p>
        {% endif %}
      </div>
    </div>
  </div>
</body>
</html>
