<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">VRMS - Admin Dashboard</span>

      <span class="navbar-text text-light me-3">
        Welcome, {{ session['name'] }}
      </span>

      <div>
        <a href="/admin/vehicles" class="btn btn-outline-light btn-sm me-2">Manage Vehicles</a>
        <a href="/admin/reports" class="btn btn-outline-light btn-sm me-2">Reports</a>
        <a href="/profile" class="btn btn-outline-light btn-sm me-2">My Profile</a>
        <a href="/logout" class="btn btn-outline-light btn-sm">Logout</a>
      </div>



    </div>
  </nav>

  <div class="container mt-4">
    <h4>Manage Users & Roles</h4>

    <a href="/admin/users/add" class="btn btn-success mb-3">+ Add User</a>

    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>UserID</th><th>Name</th><th>Email</th><th>Current Role</th><th>Change Role</th><th>Actions</th>
        </tr>
      </thead>
      <tbody>
      {% for u in users %}
        <tr>
          <td>{{ u.UserID }}</td>
          <td>{{ u.Name }}</td>
          <td>{{ u.Email }}</td>
          <td>{{ u.RoleName }}</td>
          <td>
            <form method="post" action="/admin/user/{{ u.UserID }}/set_role" class="d-flex">
              <select name="role_id" class="form-select form-select-sm me-2">
                {% for r in roles %}
                <option value="{{ r.RoleID }}" {% if r.RoleID == u.RoleID %}selected{% endif %}>
                  {{ r.RoleName }}
                </option>
                {% endfor %}
              </select>
              <button class="btn btn-sm btn-primary">Update</button>
            </form>
          </td>
          <td>
            <a href="/admin/users/edit/{{ u.UserID }}" class="btn btn-sm btn-outline-primary me-1">Edit</a>
            <a href="/admin/users/delete/{{ u.UserID }}" class="btn btn-sm btn-outline-danger"
              onclick="return confirm('Are you sure you want to delete this user?')">
              Delete
            </a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

</body>
</html>
